<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Contratación SSPI</title>
  <style>
    :root {
      --bg: #e6e9f0;
      --shadow-light: #ffffff;
      --shadow-dark: #b8b9be;
      --primary: #5b4bff;
      --text: #333;
      --required: #d90429;
    }

    * {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: var(--bg);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 40px;
    }

    .form-wrapper {
      width: 100%;
      max-width: 950px;
      background: var(--bg);
      border-radius: 25px;
      box-shadow: 12px 12px 24px var(--shadow-dark),
                  -12px -12px 24px var(--shadow-light);
      padding: 40px 50px;
      position: relative;
    }

    .logo-container {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo-container img {
      width: 180px;
      height: auto;
      filter: drop-shadow(2px 2px 4px #bbb);
    }

    h1 {
      text-align: center;
      color: var(--text);
      margin-bottom: 5px;
    }

    p {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
    }

    .progress {
      width: 100%;
      height: 8px;
      border-radius: 10px;
      background: #d1d1d6;
      margin-bottom: 30px;
      position: relative;
    }

    .progress-bar {
      position: absolute;
      height: 8px;
      border-radius: 10px;
      background: var(--primary);
      width: 12.5%;
      transition: width 0.4s ease;
    }

    section {
      display: none;
      animation: fade 0.4s ease;
    }

    section.active {
      display: block;
    }

    @keyframes fade {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: var(--text);
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
    }

    label.required::after {
      content: " *";
      color: var(--required);
    }

    input, textarea, select {
      width: 100%;
      padding: 12px 15px;
      border: none;
      border-radius: 12px;
      background: var(--bg);
      box-shadow: inset 5px 5px 10px var(--shadow-dark),
                  inset -5px -5px 10px var(--shadow-light);
      font-size: 15px;
      color: var(--text);
      margin-bottom: 20px;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      box-shadow: inset 3px 3px 6px var(--shadow-dark),
                  inset -3px -3px 6px var(--shadow-light);
    }

    .row {
      display: flex;
      gap: 20px;
    }

    .row .half {
      flex: 1;
    }

    .conditional {
      display: none;
      padding-left: 10px;
      margin-top: -10px;
    }

    .button-group {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
    }

    button {
      padding: 12px 30px;
      border-radius: 12px;
      border: none;
      background: var(--bg);
      color: var(--primary);
      font-weight: 600;
      cursor: pointer;
      box-shadow: 5px 5px 10px var(--shadow-dark),
                  -5px -5px 10px var(--shadow-light);
      transition: all 0.2s ease;
    }

    button:hover {
      box-shadow: inset 5px 5px 10px var(--shadow-dark),
                  inset -5px -5px 10px var(--shadow-light);
    }

    button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .checkbox {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 15px;
    }

    .checkbox input {
      width: 20px;
      height: 20px;
      margin-top: 3px;
    }

    .alert {
      text-align: center;
      background: #ffd7d7;
      color: #a30000;
      padding: 10px 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: none;
      box-shadow: 3px 3px 6px #ccc;
      font-weight: 500;
    }
  </style>
</head>
<body>

  <form class="form-wrapper" id="multiForm" novalidate>
    <div class="logo-container">
      <img src="LOGO GRUPO NEGRO.png" alt="Logo SSPI">
    </div>

    <h1>Formulario de Contratación</h1>
    <p>Complete los siguientes pasos para aplicar.</p>

    <div class="progress">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="alert" id="alertMsg">⚠️ Por favor, complete todos los campos obligatorios antes de continuar.</div>

    <!-- PASO 1 -->
    <section class="active">
      <h2>Datos Personales</h2>
      <div class="row">
        <div class="half">
          <label class="required">Nombre(s)</label>
          <input type="text" name="Nombre" required>
        </div>
        <div class="half">
          <label class="required">Apellido Paterno</label>
          <input type="text" name="ApellidoPaterno" required>
        </div>
      </div>
      <div class="row">
        <div class="half">
          <label>Apellido Materno</label>
          <input type="text" name="ApellidoMaterno">
        </div>
        <div class="half">
          <label class="required">Teléfono</label>
          <input type="tel" name="Telefono" required placeholder="55-1234-5678">
        </div>
      </div>
      <div class="row">
        <div class="half">
          <label class="required">Correo Electrónico</label>
          <input type="email" name="Email" required placeholder="ejemplo@correo.com">
        </div>
        <div class="half">
          <label class="required">CURP</label>
          <input type="text" name="CURP" required>
        </div>
      </div>
      <label class="required">Dirección Completa</label>
      <textarea rows="2" name="Direccion" required></textarea>
    </section>

    <!-- PASO 2 -->
    <section>
      <h2>Información General</h2>
      <div class="row">
        <div class="half">
          <label class="required">Fecha de Nacimiento</label>
          <input type="date" name="FechaNacimiento" required>
        </div>
        <div class="half">
          <label class="required">Estado Civil</label>
          <select id="estadoCivil" name="EstadoCivil" required>
            <option value="">Seleccione...</option>
            <option>Soltero(a)</option>
            <option>Casado(a)</option>
            <option>Divorciado(a)</option>
            <option>Viudo(a)</option>
            <option>Unión Libre</option>
          </select>
        </div>
      </div>
      <div id="conyugeCampos" class="conditional">
        <div class="row">
          <div class="half">
            <label>Nombre del Cónyuge</label>
            <input type="text" name="NombreConyuge">
          </div>
          <div class="half">
            <label>Ocupación del Cónyuge</label>
            <input type="text" name="OcupacionConyuge">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="half">
          <label class="required">RFC</label>
          <input type="text" name="RFC" required>
        </div>
        <div class="half">
          <label class="required">Nacionalidad</label>
          <input type="text" name="Nacionalidad" required>
        </div>
      </div>
      <label class="required">Lugar de Nacimiento</label>
      <input type="text" name="LugarNacimiento" required>

      <label>¿Cuenta con licencia para conducir?</label>
      <select id="licenciaConducir" name="LicenciaConducir">
        <option>No</option>
        <option>Sí</option>
      </select>

      <div id="licenciaCampos" class="conditional">
        <div class="row">
          <div class="half">
            <label>Clase</label>
            <input type="text" name="ClaseLicencia">
          </div>
          <div class="half">
            <label>Número</label>
            <input type="text" name="NumeroLicencia">
          </div>
        </div>
        <label>¿Sabe manejar estándar?</label>
        <select name="ManejaEstandar">
          <option>No</option>
          <option>Sí</option>
        </select>
      </div>

      <div class="row">
        <div class="half">
          <label>¿Cuenta con cartilla militar?</label>
          <select name="CartillaMilitar">
            <option>No</option>
            <option>Sí</option>
          </select>
        </div>
        <div class="half">
          <label>¿Cuenta con visa láser vigente?</label>
          <select name="VisaLaser">
            <option>No</option>
            <option>Sí</option>
          </select>
        </div>
      </div>
    </section>

    <!-- PASO 3 -->
    <section>
      <h2>Información Económica</h2>
      <label>¿Cuenta con crédito INFONAVIT?</label>
      <select id="infonavit" name="CreditoINFONAVIT">
        <option>No</option>
        <option>Sí</option>
      </select>
      <div id="infonavitCampos" class="conditional">
        <div class="row">
          <div class="half">
            <label>No. de Crédito</label>
            <input type="text" name="NumeroInfonavit">
          </div>
          <div class="half">
            <label>Pago Semanal</label>
            <input type="number" name="PagoInfonavit">
          </div>
        </div>
      </div>

      <label>¿Cuenta con crédito FONACOT?</label>
      <select id="fonacot" name="CreditoFONACOT">
        <option>No</option>
        <option>Sí</option>
      </select>
      <div id="fonacotCampos" class="conditional">
        <div class="row">
          <div class="half">
            <label>No. de Crédito</label>
            <input type="text" name="NumeroFonacot">
          </div>
          <div class="half">
            <label>Pago Semanal</label>
            <input type="number" name="PagoFonacot">
          </div>
        </div>
      </div>

      <label>¿Tiene pensión alimenticia?</label>
      <select id="pension" name="PensionAlimenticia">
        <option>No</option>
        <option>Sí</option>
      </select>
      <div id="pensionCampos" class="conditional">
        <label>¿Qué cantidad paga?</label>
        <input type="number" name="CantidadPension">
      </div>
    </section>

    <!-- PASO 4 -->
    <section>
      <h2>Estado de Salud</h2>
      <label class="required">Tipo de Sangre</label>
      <select name="TipoSangre" required>
        <option value="">Seleccione...</option>
        <option>A+</option><option>A-</option>
        <option>B+</option><option>B-</option>
        <option>AB+</option><option>AB-</option>
        <option>O+</option><option>O-</option>
      </select>
      <label class="required">NSS</label>
      <input type="text" name="NSS" required>
      <label>Enfermedad o condición médica</label>
      <input type="text" name="Enfermedad">
      <label>Alergias</label>
      <input type="text" name="Alergias">
      <label>Medicamento Regular</label>
      <input type="text" name="Medicamento">
    </section>

    <!-- PASO 5 -->
    <section>
      <h2>Contacto de Emergencia</h2>
      <label class="required">Nombre Completo</label>
      <input type="text" name="ContactoNombre" required>
      <label class="required">Parentesco</label>
      <input type="text" name="ContactoParentesco" required>
      <label class="required">Dirección</label>
      <input type="text" name="ContactoDireccion" required>
      <label class="required">Teléfono</label>
      <input type="tel" name="ContactoTelefono" required>
    </section>

    <!-- PASO 6 -->
    <section>
      <h2>Escolaridad</h2>
      <label class="required">Nivel Educativo</label>
      <select name="NivelEducativo" required>
        <option value="">Seleccione...</option>
        <option>Primaria</option><option>Secundaria</option>
        <option>Preparatoria/Bachillerato</option>
        <option>Licenciatura</option><option>Maestría</option>
        <option>Doctorado</option>
      </select>
      <label class="required">Estatus</label>
      <select name="EstatusEscolar" required>
        <option value="">Seleccione...</option>
        <option>Terminado</option><option>Trunco</option><option>En curso</option>
      </select>
      <label>Certificaciones o Cursos</label>
      <textarea rows="2" name="Certificaciones"></textarea>
      <div class="row">
        <div class="half">
          <label class="required">Inglés Hablado</label>
          <select name="InglesHablado" required>
            <option value="">Seleccione...</option>
            <option>Principiante</option><option>Básico</option>
            <option>Intermedio</option><option>Avanzado</option>
            <option>Nativo</option>
          </select>
        </div>
        <div class="half">
          <label class="required">Inglés Escrito</label>
          <select name="InglesEscrito" required>
            <option value="">Seleccione...</option>
            <option>Principiante</option><option>Básico</option>
            <option>Intermedio</option><option>Avanzado</option>
            <option>Nativo</option>
          </select>
        </div>
      </div>
    </section>

    <!-- PASO 7 -->
    <section>
      <h2>Último Empleo</h2>
      <label class="required">Empresa</label>
      <input type="text" name="EmpresaUltimoEmpleo" required>
      <label class="required">Puesto</label>
      <input type="text" name="PuestoUltimoEmpleo" required>
      <label>Actividades Realizadas</label>
      <textarea rows="3" name="ActividadesUltimoEmpleo" placeholder="Describe brevemente tus principales funciones..."></textarea>
    </section>

    <!-- PASO 8 -->
    <section>
      <h2>Referencias Personales</h2>
      <h3>Referencia 1</h3>
      <label class="required">Nombre Completo</label>
      <input type="text" name="Referencia1Nombre" required>
      <label class="required">Teléfono</label>
      <input type="tel" name="Referencia1Telefono" required>

      <h3>Referencia 2</h3>
      <label class="required">Nombre Completo</label>
      <input type="text" name="Referencia2Nombre" required>
      <label class="required">Teléfono</label>
      <input type="tel" name="Referencia2Telefono" required>
    </section>

    <!-- PASO 9 -->
    <section>
      <h2>Declaración</h2>
      <div class="checkbox">
        <input type="checkbox" name="DeclaracionVeracidad" required>
        <label>Hago constar que las respuestas son verdaderas y estoy consciente de que cualquier falsedad será motivo de rechazo o despido.</label>
      </div>
      <div class="checkbox">
        <input type="checkbox" name="DeclaracionDatos" required>
        <label>Autorizo a SOPORTE Y SERVICIOS EN PRODUCTOS INDUSTRIALES, S. DE R.L. DE C.V. a recabar y usar mis datos personales conforme a la Ley Federal de Protección de Datos Personales en Posesión de los Particulares.</label>
      </div>
      <p style="text-align:center; margin-top:20px; color:#555;">
        <b>Gracias por completar tu solicitud.</b><br>
        Presiona “Enviar” para finalizar.
      </p>
    </section>

    <div class="button-group">
      <button type="button" id="prevBtn">Anterior</button>
      <button type="button" id="nextBtn">Siguiente</button>
    </div>
    <!-- Mensaje de estado de envío -->
  <div id="statusMsg" class="alert" style="display:none; background:#cce5ff; color:#004085;">Enviando...</div>
  </form>
<script>
const sections = document.querySelectorAll('section');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const progressBar = document.getElementById('progressBar');
const alertMsg = document.getElementById('alertMsg');
let current = 0;

function showStep(index){
  sections.forEach((sec,i)=>sec.classList.toggle('active',i===index));
  prevBtn.disabled=index===0;
  nextBtn.textContent=index===sections.length-1?'Enviar':'Siguiente';
  progressBar.style.width=((index+1)/sections.length)*100+'%';
  alertMsg.style.display='none';
}

function validateSection(section){
  const requiredFields=section.querySelectorAll('[required]');
  for(const f of requiredFields){
    if((f.type==='checkbox'&&!f.checked)||(!f.value||!f.value.trim())){f.focus();return false;}
  }
  return true;
}

function buildFormData(){
  const data={};
  document.querySelectorAll('input,select,textarea').forEach(el=>{
    const key=el.name?.trim(); if(!key)return;
    data[key]=el.type==='checkbox'?(el.checked?'Sí':'No'):(el.value||'');
  });
  return data;
}

function submitFormViaIframe(formData,url){
  return new Promise((resolve,reject)=>{
    let iframe=document.getElementById('gs-target-iframe');
    if(!iframe){
      iframe=document.createElement('iframe');
      iframe.id='gs-target-iframe';iframe.name='gs-target-iframe';
      iframe.style.display='none';document.body.appendChild(iframe);
    }
    function onMsg(e){window.removeEventListener('message',onMsg);
      try{if(e.data&&e.data.result==='success')resolve({ok:true});else reject();}catch(err){reject(err);}
    }
    window.addEventListener('message',onMsg);
    const form=document.createElement('form');form.style.display='none';
    form.method='POST';form.action=url;form.target=iframe.name;
    for(const k in formData){
      const i=document.createElement('input');i.type='hidden';i.name=k;i.value=formData[k];form.appendChild(i);
    }
    document.body.appendChild(form);form.submit();setTimeout(()=>form.remove(),2000);
  });
}

const SCRIPT_URL="https://script.google.com/macros/s/AKfycbw496Fmw32LD_D9Hv3wYSzoTfYtcm7uRzFnNhOPr2FMpy8PECf2erSiT_z8H7vVV64NRQ/exec";

nextBtn.addEventListener('click',()=>{
  const sec=sections[current];
  if(!validateSection(sec)){alertMsg.style.display='block';return;}
  if(current<sections.length-1){current++;showStep(current);}
  else{
    const formData=buildFormData();
    nextBtn.disabled=true;prevBtn.disabled=true;alertMsg.style.display='none';
    nextBtn.textContent='Enviando...';
    progressBar.style.width='0';let p=0;
    const interval=setInterval(()=>{p+=5;if(p>95)p=95;progressBar.style.width=p+'%';},100);
    submitFormViaIframe(formData,SCRIPT_URL).catch(()=>{});
    setTimeout(()=>{
      clearInterval(interval);
      progressBar.style.width='100%';
      nextBtn.textContent='✅ Tu solicitud se registró correctamente';
      nextBtn.style.background='#4ade80';nextBtn.style.color='#fff';
      setTimeout(()=>window.location.reload(),1800);
    },1000);
  }
});

prevBtn.addEventListener('click',()=>{if(current>0)current--;showStep(current);});
showStep(current);
</script>
</body>
</html>



















